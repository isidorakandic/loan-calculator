<svg xmlns="http://www.w3.org/2000/svg" width="940" height="520" viewBox="0 0 940 520" font-family="Arial,Helvetica,sans-serif">
  <style>
    .lifeline { stroke: #4a5568; stroke-width: 2; }
    .activation { fill: #c3dafe; stroke: #2c5282; stroke-width: 2; }
    .label { font-size: 14px; font-weight: bold; fill: #2d3748; }
    .message { stroke: #2d3748; stroke-width: 2; marker-end: url(#arrow); }
    .note { fill: #fefcbf; stroke: #d69e2e; stroke-width: 1; }
  </style>
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#2d3748" />
    </marker>
  </defs>

  <!-- Lifelines -->
  <text class="label" x="70" y="30">Client</text>
  <line class="lifeline" x1="90" y1="50" x2="90" y2="480" stroke-dasharray="6 6" />

  <text class="label" x="260" y="30">LoanCalculatorController</text>
  <line class="lifeline" x1="300" y1="50" x2="300" y2="480" stroke-dasharray="6 6" />

  <text class="label" x="510" y="30">LoanCalculationService</text>
  <line class="lifeline" x1="540" y1="50" x2="540" y2="480" stroke-dasharray="6 6" />

  <text class="label" x="750" y="30">LoanRepository</text>
  <line class="lifeline" x1="780" y1="50" x2="780" y2="480" stroke-dasharray="6 6" />

  <!-- Messages -->
  <rect class="activation" x="280" y="100" width="40" height="70" />
  <line class="message" x1="90" y1="120" x2="300" y2="120" />
  <text x="130" y="110" font-size="13" fill="#2d3748">POST /calculate(principal, rate, term)</text>

  <rect class="activation" x="520" y="180" width="40" height="180" />
  <line class="message" x1="300" y1="190" x2="540" y2="190" />
  <text x="325" y="180" font-size="13" fill="#2d3748">validate + computeSchedule()</text>

  <rect class="activation" x="760" y="230" width="40" height="100" />
  <line class="message" x1="540" y1="240" x2="780" y2="240" />
  <text x="565" y="230" font-size="13" fill="#2d3748">save(Loan)</text>

  <line class="message" x1="780" y1="280" x2="540" y2="280" />
  <text x="610" y="270" font-size="13" fill="#2d3748">persisted Loan</text>

  <line class="message" x1="540" y1="330" x2="300" y2="330" />
  <text x="370" y="320" font-size="13" fill="#2d3748">LoanSchedule DTO</text>

  <line class="message" x1="300" y1="360" x2="90" y2="360" />
  <text x="150" y="350" font-size="13" fill="#2d3748">JSON schedule response</text>

  <!-- Notes -->
  <rect class="note" x="560" y="380" width="240" height="70" rx="6" />
  <text x="575" y="405" font-size="12" fill="#2d3748">Validation, amortization math, and mapping</text>
  <text x="575" y="425" font-size="12" fill="#2d3748">from domain Loan to LoanSchedule DTO are</text>
  <text x="575" y="445" font-size="12" fill="#2d3748">handled entirely in the service layer.</text>
</svg>
