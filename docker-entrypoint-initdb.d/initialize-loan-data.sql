-- Initialize loan_calculator schema and seed initial loan request data
CREATE DATABASE IF NOT EXISTS loan_calculator;
USE loan_calculator;

-- Loan requests table
CREATE TABLE IF NOT EXISTS loan_request (
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    loan_amount DECIMAL(19,2),
    interest_rate DECIMAL(5,2),
    loan_term INT,
    creation_timestamp DATETIME
);

-- Installments table
CREATE TABLE IF NOT EXISTS installment (
    id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `month` INT NOT NULL,
    payment_amount DECIMAL(19,2) NOT NULL,
    principal_amount DECIMAL(19,2) NOT NULL,
    interest_amount DECIMAL(19,2) NOT NULL,
    balance_owed DECIMAL(19,2) NOT NULL,
    loan_request_id BIGINT NOT NULL,
    CONSTRAINT fk_installment_loan_request FOREIGN KEY (loan_request_id) REFERENCES loan_request(id)
);

-- Seed loan requests
INSERT INTO loan_request (id, loan_amount, interest_rate, loan_term, creation_timestamp) VALUES
    (1, 18000.00, 5.30, 60, '2025-12-17 19:33:00'),
    (2, 5000.00, 7.20, 12, '2025-12-17 19:34:00'),
    (3, 50000.00, 3.00, 36, '2025-12-17 19:34:00');

-- Seed installments for loan request 1
INSERT INTO installment (`month`, payment_amount, principal_amount, interest_amount, balance_owed, loan_request_id) VALUES
    (1, 342.16, 262.66, 79.50, 17737.34, 1),
    (2, 342.16, 263.82, 78.34, 17473.52, 1),
    (3, 342.16, 264.99, 77.17, 17208.53, 1),
    (4, 342.16, 266.16, 76.00, 16942.37, 1),
    (5, 342.16, 267.33, 74.83, 16675.04, 1),
    (6, 342.16, 268.51, 73.65, 16406.53, 1),
    (7, 342.16, 269.70, 72.46, 16136.83, 1),
    (8, 342.16, 270.89, 71.27, 15865.94, 1),
    (9, 342.16, 272.09, 70.07, 15593.85, 1),
    (10, 342.16, 273.29, 68.87, 15320.56, 1),
    (11, 342.16, 274.49, 67.67, 15046.07, 1),
    (12, 342.16, 275.71, 66.45, 14770.36, 1),
    (13, 342.16, 276.92, 65.24, 14493.44, 1),
    (14, 342.16, 278.15, 64.01, 14215.29, 1),
    (15, 342.16, 279.38, 62.78, 13935.91, 1),
    (16, 342.16, 280.61, 61.55, 13655.30, 1),
    (17, 342.16, 281.85, 60.31, 13373.45, 1),
    (18, 342.16, 283.09, 59.07, 13090.36, 1),
    (19, 342.16, 284.34, 57.82, 12806.02, 1),
    (20, 342.16, 285.60, 56.56, 12520.42, 1),
    (21, 342.16, 286.86, 55.30, 12233.56, 1),
    (22, 342.16, 288.13, 54.03, 11945.43, 1),
    (23, 342.16, 289.40, 52.76, 11656.03, 1),
    (24, 342.16, 290.68, 51.48, 11365.35, 1),
    (25, 342.16, 291.96, 50.20, 11073.39, 1),
    (26, 342.16, 293.25, 48.91, 10780.14, 1),
    (27, 342.16, 294.55, 47.61, 10485.59, 1),
    (28, 342.16, 295.85, 46.31, 10189.74, 1),
    (29, 342.16, 297.16, 45.00, 9892.58, 1),
    (30, 342.16, 298.47, 43.69, 9594.11, 1),
    (31, 342.16, 299.79, 42.37, 9294.32, 1),
    (32, 342.16, 301.11, 41.05, 8993.21, 1),
    (33, 342.16, 302.44, 39.72, 8690.77, 1),
    (34, 342.16, 303.78, 38.38, 8386.99, 1),
    (35, 342.16, 305.12, 37.04, 8081.87, 1),
    (36, 342.16, 306.47, 35.69, 7775.40, 1),
    (37, 342.16, 307.82, 34.34, 7467.58, 1),
    (38, 342.16, 309.18, 32.98, 7158.40, 1),
    (39, 342.16, 310.54, 31.62, 6847.86, 1),
    (40, 342.16, 311.92, 30.24, 6535.94, 1),
    (41, 342.16, 313.29, 28.87, 6222.65, 1),
    (42, 342.16, 314.68, 27.48, 5907.97, 1),
    (43, 342.16, 316.07, 26.09, 5591.90, 1),
    (44, 342.16, 317.46, 24.70, 5274.44, 1),
    (45, 342.16, 318.86, 23.30, 4955.58, 1),
    (46, 342.16, 320.27, 21.89, 4635.31, 1),
    (47, 342.16, 321.69, 20.47, 4313.62, 1),
    (48, 342.16, 323.11, 19.05, 3990.51, 1),
    (49, 342.16, 324.54, 17.62, 3665.97, 1),
    (50, 342.16, 325.97, 16.19, 3340.00, 1),
    (51, 342.16, 327.41, 14.75, 3012.59, 1),
    (52, 342.16, 328.85, 13.31, 2683.74, 1),
    (53, 342.16, 330.31, 11.85, 2353.43, 1),
    (54, 342.16, 331.77, 10.39, 2021.66, 1),
    (55, 342.16, 333.23, 8.93, 1688.43, 1),
    (56, 342.16, 334.70, 7.46, 1353.73, 1),
    (57, 342.16, 336.18, 5.98, 1017.55, 1),
    (58, 342.16, 337.67, 4.49, 679.88, 1),
    (59, 342.16, 339.16, 3.00, 340.72, 1),
    (60, 342.22, 340.72, 1.50, 0.00, 1);

-- Seed installments for loan request 2
INSERT INTO installment (`month`, payment_amount, principal_amount, interest_amount, balance_owed, loan_request_id) VALUES
    (1, 433.09, 403.09, 30.00, 4596.91, 2),
    (2, 433.09, 405.51, 27.58, 4191.40, 2),
    (3, 433.09, 407.94, 25.15, 3783.46, 2),
    (4, 433.09, 410.39, 22.70, 3373.07, 2),
    (5, 433.09, 412.85, 20.24, 2960.22, 2),
    (6, 433.09, 415.33, 17.76, 2544.89, 2),
    (7, 433.09, 417.82, 15.27, 2127.07, 2),
    (8, 433.09, 420.33, 12.76, 1706.74, 2),
    (9, 433.09, 422.85, 10.24, 1283.89, 2),
    (10, 433.09, 425.39, 7.70, 858.50, 2),
    (11, 433.09, 427.94, 5.15, 430.56, 2),
    (12, 433.14, 430.56, 2.58, 0.00, 2);

-- Seed installments for loan request 3
INSERT INTO installment (`month`, payment_amount, principal_amount, interest_amount, balance_owed, loan_request_id) VALUES
    (1, 1454.06, 1329.06, 125.00, 48670.94, 3),
    (2, 1454.06, 1332.38, 121.68, 47338.56, 3),
    (3, 1454.06, 1335.71, 118.35, 46002.85, 3),
    (4, 1454.06, 1339.05, 115.01, 44663.80, 3),
    (5, 1454.06, 1342.40, 111.66, 43321.40, 3),
    (6, 1454.06, 1345.76, 108.30, 41975.64, 3),
    (7, 1454.06, 1349.12, 104.94, 40626.52, 3),
    (8, 1454.06, 1352.49, 101.57, 39274.03, 3),
    (9, 1454.06, 1355.87, 98.19, 37918.16, 3),
    (10, 1454.06, 1359.26, 94.80, 36558.90, 3),
    (11, 1454.06, 1362.66, 91.40, 35196.24, 3),
    (12, 1454.06, 1366.07, 87.99, 33830.17, 3),
    (13, 1454.06, 1369.48, 84.58, 32460.69, 3),
    (14, 1454.06, 1372.91, 81.15, 31087.78, 3),
    (15, 1454.06, 1376.34, 77.72, 29711.44, 3),
    (16, 1454.06, 1379.78, 74.28, 28331.66, 3),
    (17, 1454.06, 1383.23, 70.83, 26948.43, 3),
    (18, 1454.06, 1386.69, 67.37, 25561.74, 3),
    (19, 1454.06, 1390.16, 63.90, 24171.58, 3),
    (20, 1454.06, 1393.63, 60.43, 22777.95, 3),
    (21, 1454.06, 1397.12, 56.94, 21380.83, 3),
    (22, 1454.06, 1400.61, 53.45, 19980.22, 3),
    (23, 1454.06, 1404.11, 49.95, 18576.11, 3),
    (24, 1454.06, 1407.62, 46.44, 17168.49, 3),
    (25, 1454.06, 1411.14, 42.92, 15757.35, 3),
    (26, 1454.06, 1414.67, 39.39, 14342.68, 3),
    (27, 1454.06, 1418.20, 35.86, 12924.48, 3),
    (28, 1454.06, 1421.75, 32.31, 11502.73, 3),
    (29, 1454.06, 1425.30, 28.76, 10077.43, 3),
    (30, 1454.06, 1428.87, 25.19, 8648.56, 3),
    (31, 1454.06, 1432.44, 21.62, 7216.12, 3),
    (32, 1454.06, 1436.02, 18.04, 5780.10, 3),
    (33, 1454.06, 1439.61, 14.45, 4340.49, 3),
    (34, 1454.06, 1443.21, 10.85, 2897.28, 3),
    (35, 1454.06, 1446.82, 7.24, 1450.46, 3),
    (36, 1454.09, 1450.46, 3.63, 0.00, 3);

-- Ensure future inserts continue after seeded IDs
ALTER TABLE loan_request AUTO_INCREMENT = 4;
ALTER TABLE installment AUTO_INCREMENT = 109;
